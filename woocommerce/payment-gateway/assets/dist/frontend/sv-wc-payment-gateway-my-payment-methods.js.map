{"version":3,"sources":["frontend/sv-wc-payment-gateway-my-payment-methods.coffee"],"names":[],"mappings":";AAOG,SAAA,EAAA,EAAA,GAAA,KAAA,aAAA,GAAA,MAAA,IAAA,UAAA,qCAAA,SAAA,EAAA,EAAA,GAAA,IAAA,IAAA,EAAA,EAAA,EAAA,EAAA,OAAA,IAAA,CAAA,IAAA,EAAA,EAAA,GAAA,EAAA,WAAA,EAAA,aAAA,EAAA,EAAA,cAAA,EAAA,UAAA,IAAA,EAAA,UAAA,GAAA,OAAA,eAAA,EAAA,EAAA,IAAA,IAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,GAAA,EAAA,EAAA,UAAA,GAAA,GAAA,EAAA,EAAA,GAAA,GAAA,WACH,OAAQ,UAAW,MAAM,SAAC,GAAD,aAuQxB,OAjQM,OAAO,sCAAP,WAaU,SAAA,EAAA,GAAF,IAAA,EAAA,KAAA,EAAA,KAAA,GA8Cb,KAAA,sBAAA,KAAA,sBAAA,KAAA,MA4BA,KAAA,+BAAA,KAAA,+BAAA,KAAA,MAYA,KAAA,YAAA,KAAA,YAAA,KAAA,MA0BA,KAAA,YAAA,KAAA,YAAA,KAAA,MAqDA,KAAA,YAAA,KAAA,YAAA,KAAA,MAnKE,KAAA,GAAa,EAAK,GAClB,KAAA,KAAa,EAAK,KAClB,KAAA,KAAa,EAAK,KAClB,KAAA,SAAa,EAAK,SAClB,KAAA,WAAa,EAAK,WAGd,KAAA,wBAGA,KAAA,iCAGL,EAAG,yCAA0C,GAAI,QAAS,mDAAoD,SAAE,GAAW,OAAA,EAAK,YAAa,KAG7I,EAAG,yCAA0C,GAAI,QAAS,mDAAoD,SAAE,GAAW,OAAA,EAAK,YAAa,KAG7I,EAAG,yCAA0C,GAAI,QAAS,mDAAoD,SAAE,GAAW,OAAA,EAAK,YAAa,KAG7I,EAAG,yCAA0C,GAAI,QAAS,qDAAsD,SAAE,GAM9G,GAA8D,IAJxD,EAAG,EAAM,eACF,QAAS,MAGlB,KAAqC,+BAAA,OAAA,EAAC,KAAU,MAAA,OAGpD,OAAA,EAAG,EAAM,eAAgB,SAAU,cAAoB,QAAS,EAAC,KAAK,YACxE,EAAM,sBADJ,IAMJ,EAAG,uCAAwC,MAAM,SAAE,GACxB,GAAA,EAAG,MAAO,SAAU,YAA9C,OAAA,EAAM,mBArDH,OAAA,EAAA,EAAA,CAAA,CAAA,IAAA,wBA2DkB,MAAA,WAAA,IAAA,EAAA,KAEtB,OAAA,EAAG,yCAA0C,KAAM,MAAO,KAAK,SAAE,EAAO,GAE3E,IAAA,EACO,GAAuE,IAAvE,EAAG,GAAU,KAAqC,+BAAA,OAAA,EAAC,KAAU,MAAA,OAehE,OAXA,EAAG,GAAU,KAAM,uCAAwC,UAE3D,EAAc,EAAG,GAAU,KAAM,wCAGhB,WAAW,OAAS,GAGpC,EAAG,GAAU,KAAM,wCAAyC,KAAM,EAAY,QAG/E,EAAG,GAAU,KAAM,uCAAwC,aA/ExD,CAAA,IAAA,iCAuF2B,MAAA,WAE/B,OAAA,EAAG,yCAA0C,KAAM,MAAO,KAAK,SAAE,EAAO,GAEvE,OAAA,EAAG,GAAU,KAAM,yCAA0C,KAAM,kCAAmC,aA3FnG,CAAA,IAAA,cAmGU,MAAA,SAAA,GAEjB,IAAA,EAAA,EAMM,GANH,EAAM,iBAM2D,KAHjE,GADA,EAAS,EAAG,EAAM,gBACF,QAAS,OAGlB,KAAqC,+BAAA,OAAA,KAAC,KAAU,MAAA,OAUvD,OAPA,EAAI,KAAM,YAAa,OACvB,EAAI,KAAM,YAAa,OACvB,EAAI,SAAU,WAGd,EAAO,KAAM,KAAC,KAAK,eAAgB,YAAa,QAAS,SAAU,eAAgB,YAAa,UAEhG,KAAK,sBArHD,CAAA,IAAA,cA6HU,MAAA,SAAA,GAAF,IAEf,EAAA,EAAA,EAFe,EAAA,KAQT,GANH,EAAM,iBAEN,EAAS,EAAG,EAAM,eAI+C,KAHjE,EAAS,EAAO,QAAS,OAGlB,KAAqC,+BAAA,OAAA,KAAC,KAAU,MAAA,OAcvD,OAXK,KAAA,WAGL,EAAI,KAAM,UAAW,SAErB,EACC,CAAA,OAAgB,MAAA,OAAA,KAAC,GAAjB,wBACA,MAAU,KAAC,WACX,SAAU,EAAI,KAAM,wBAAyB,MAC7C,KAAU,EAAI,KAAM,eAAgB,aAErC,EAAE,KAAM,KAAC,SAAU,GAEjB,KAAK,SAAE,GAEP,OAAuD,EAAS,SAE7D,MAAA,EAAA,KAAA,OACF,EAAI,KAAK,sCAAsC,KAAM,EAAS,KAAK,OAEjE,MAAA,EAAA,KAAA,QACF,EAAC,WAAa,EAAS,KAAK,OAG7B,EAAO,SAAU,gBAAiB,YAAa,eAAgB,SAAU,QAAS,KAAM,EAAC,KAAK,aAAc,SAAU,UAEtH,EAAK,sBAXE,EAAK,cAAe,EAAK,EAAS,QAazC,KAAK,SAAE,EAAO,EAAY,GAE1B,OAAA,EAAK,cAAe,EAAK,KAEzB,OAAO,WAEP,OAAA,EAAK,iBA1KH,CAAA,IAAA,cAkLU,MAAA,SAAA,GAEjB,IAAA,EAAA,EAMM,GANH,EAAM,iBAM2D,KAHjE,GADA,EAAS,EAAG,EAAM,gBACF,QAAS,OAGlB,KAAqC,+BAAA,OAAA,KAAC,KAAU,MAAA,OAUvD,OAPA,EAAI,KAAM,YAAa,OACvB,EAAI,KAAM,YAAa,OACvB,EAAI,YAAa,WAGjB,EAAO,YAAa,eAAgB,SAAU,QAAS,KAAM,KAAC,KAAK,aAAc,SAAU,UAE3F,KAAK,uBApMD,CAAA,IAAA,oBA6Mc,MAAA,WAMlB,OAHA,EAAG,yCAA0C,SAAU,WAGvD,EAAG,uCAAwC,SAAU,cAnNjD,CAAA,IAAA,qBAyNe,MAAA,WAMnB,OAHA,EAAG,yCAA0C,YAAa,WAG1D,EAAG,uCAAwC,YAAa,cA/NpD,CAAA,IAAA,WAqOK,MAAA,WAAG,OAAA,EAAG,yCAA0C,OAAQ,OAAQ,MAAO,CAAA,QAAS,KAAM,WAAY,CAAA,WAAY,OAAQ,QAAS,QArOpI,CAAA,IAAA,aA2OO,MAAA,WAAG,OAAA,EAAG,yCAA0C,OAAQ,OAAQ,YA3OvE,CAAA,IAAA,gBAqPY,MAAA,SAAA,EAAK,GAAO,IAE/B,EAF+B,EAAU,UAAA,OAAA,QAAA,IAAA,UAAA,GAAA,UAAA,GAAA,GAQtC,OANA,QAAQ,MAAO,GAEmB,IAAlC,EAAU,KAAC,KAAK,YAEhB,EAAU,EAAG,qDAAsD,OAEnE,EAAG,kCAAoC,EAAU,KAAO,EAAU,cAAe,YAAa,GAAM,KAAM,MAAO,MAAO,KAAO,QAAS,SA7PpI,EAAA,GAiQN,EAAG,SAAS,MAAO,QAAS,oDAxQ1B,KAAA","file":"sv-wc-payment-gateway-my-payment-methods.js","sourceRoot":"../js","sourcesContent":["###\n WooCommerce SkyVerge Payment Gateway My Payment Methods CoffeeScript\n Version 5.1.0\n\n Copyright (c) 2014-2020, SkyVerge, Inc.\n Licensed under the GNU General Public License v3.0\n http://www.gnu.org/licenses/gpl-3.0.html\n###\njQuery( document ).ready ($) ->\n\t\"use strict\"\n\n\t# The My Payment Methods handler.\n\t#\n\t# @since 5.1.0\n\tclass window.SV_WC_Payment_Methods_Handler_v5_10_0\n\n\n\t\t# Constructs the class.\n\t\t#\n\t\t# @since 5.1.0\n\t\t#\n\t\t# @param [Object] args, with the properties:\n\t\t#     id:         [String] plugin ID\n\t\t#     slug:       [String] plugin slug or dasherized ID\n\t\t#     i18n:       [Object] localized text strings\n\t\t#     ajax_url:   [String] URL for AJAX requests\n\t\t#     ajax_nonce: [String] nonce for AJAX requests\n\t\tconstructor: ( args ) ->\n\n\t\t\t@id         = args.id\n\t\t\t@slug       = args.slug\n\t\t\t@i18n       = args.i18n\n\t\t\t@ajax_url   = args.ajax_url\n\t\t\t@ajax_nonce = args.ajax_nonce\n\n\t\t\t# replace the \"Method\" column content for FW tokens\n\t\t\tthis.replace_method_column()\n\n\t\t\t# remove duplicate \"Default\" marks\n\t\t\tthis.remove_duplicate_default_marks()\n\n\t\t\t# handle the edit action\n\t\t\t$( \".woocommerce-MyAccount-paymentMethods\" ).on( 'click', \".woocommerce-PaymentMethod--actions .button.edit\", ( event ) => this.edit_method( event ) )\n\n\t\t\t# handle the save action\n\t\t\t$( \".woocommerce-MyAccount-paymentMethods\" ).on( 'click', \".woocommerce-PaymentMethod--actions .button.save\", ( event ) => this.save_method( event ) )\n\n\t\t\t# handle the cancel action\n\t\t\t$( \".woocommerce-MyAccount-paymentMethods\" ).on( 'click', \".woocommerce-PaymentMethod--actions .cancel-edit\", ( event ) => this.cancel_edit( event ) )\n\n\t\t\t# handle the delete action\n\t\t\t$( \".woocommerce-MyAccount-paymentMethods\" ).on( 'click', \".woocommerce-PaymentMethod--actions .button.delete\", ( event ) =>\n\n\t\t\t\tbutton = $( event.currentTarget )\n\t\t\t\trow    = button.parents( 'tr' )\n\n\t\t\t\t# check if the method belongs to this plugin\n\t\t\t\tif row.find( \"input[name=plugin-id][value=#{@slug}]\" ).length is 0\n\t\t\t\t\treturn\n\n\t\t\t\tif $( event.currentTarget ).hasClass( 'disabled' ) or not confirm( @i18n.delete_ays )\n\t\t\t\t\tevent.preventDefault()\n\n\t\t\t)\n\n\t\t\t# don't follow the Add Payment Method button URL if it's disabled\n\t\t\t$( '.button[href*=\"add-payment-method\"]' ).click ( event ) ->\n\t\t\t\tevent.preventDefault() if $( this ).hasClass( 'disabled' )\n\n\n\t\t# Replace Method column content with Title column content, for FW tokens.\n\t\t#\n\t\t# @since 5.8.0\n\t\treplace_method_column: =>\n\n\t\t\t$( '.woocommerce-MyAccount-paymentMethods' ).find( 'tr' ).each ( index, element ) =>\n\n\t\t\t\t# check if the method belongs to this plugin\n\t\t\t\tif $( element ).find( \"input[name=plugin-id][value=#{@slug}]\" ).length is 0\n\t\t\t\t\treturn\n\n\t\t\t\t# delete the Title header\n\t\t\t\t$( element ).find( 'th.woocommerce-PaymentMethod--title' ).remove()\n\n\t\t\t\ttitleColumn = $( element ).find( 'td.woocommerce-PaymentMethod--title' )\n\n\t\t\t\t# Title column is not empty, this is a FW token\n\t\t\t\tif ( titleColumn.children().length > 0 )\n\n\t\t\t\t\t# replace Method column\n\t\t\t\t\t$( element ).find( 'td.woocommerce-PaymentMethod--method' ).html( titleColumn.html() )\n\n\t\t\t\t# delete Title column\n\t\t\t\t$( element ).find( 'td.woocommerce-PaymentMethod--title' ).remove()\n\n\n\t\t# Removes duplicate \"Default\" marks.\n\t\t#\n\t\t# They are already hidden using CSS, but should also be removed for accessibility.\n\t\t#\n\t\t# @since 5.8.0\n\t\tremove_duplicate_default_marks: =>\n\n\t\t\t$( '.woocommerce-MyAccount-paymentMethods' ).find( 'tr' ).each ( index, element ) =>\n\n\t\t\t\t$( element ).find( 'td.woocommerce-PaymentMethod--default' ).find( 'mark.default:not(:first-child)' ).remove()\n\n\n\t\t# Edits a payment method.\n\t\t#\n\t\t# @since 5.1.0\n\t\t#\n\t\t# @param [Object] event jQuery event object\n\t\tedit_method: ( event ) =>\n\n\t\t\tevent.preventDefault()\n\n\t\t\tbutton = $( event.currentTarget )\n\t\t\trow    = button.parents( 'tr' )\n\n\t\t\t# check if the method belongs to this plugin\n\t\t\tif row.find( \"input[name=plugin-id][value=#{@slug}]\" ).length is 0\n\t\t\t\treturn\n\n\t\t\trow.find( 'div.view' ).hide()\n\t\t\trow.find( 'div.edit' ).show()\n\t\t\trow.addClass( 'editing' )\n\n\t\t\t# change the Edit button to \"Cancel\"\n\t\t\tbutton.text( @i18n.cancel_button ).removeClass( 'edit' ).addClass( 'cancel-edit' ).removeClass( 'button' )\n\n\t\t\tthis.enable_editing_ui()\n\n\n\t\t# Saves a payment method.\n\t\t#\n\t\t# @since 5.1.0\n\t\t#\n\t\t# @param [Object] event jQuery event object\n\t\tsave_method: ( event ) =>\n\n\t\t\tevent.preventDefault()\n\n\t\t\tbutton = $( event.currentTarget )\n\t\t\trow    = button.parents( 'tr' )\n\n\t\t\t# check if the method belongs to this plugin\n\t\t\tif row.find( \"input[name=plugin-id][value=#{@slug}]\" ).length is 0\n\t\t\t\treturn\n\n\t\t\tthis.block_ui()\n\n\t\t\t# remove any previous errors\n\t\t\trow.next( '.error' ).remove()\n\n\t\t\tdata =\n\t\t\t\taction:   \"wc_#{@id}_save_payment_method\"\n\t\t\t\tnonce:    @ajax_nonce\n\t\t\t\ttoken_id: row.find( 'input[name=token-id]' ).val()\n\t\t\t\tdata:     row.find( 'input[name]' ).serialize()\n\n\t\t\t$.post( @ajax_url, data )\n\n\t\t\t\t.done ( response ) =>\n\n\t\t\t\t\treturn this.display_error( row, response.data ) unless response.success\n\n\t\t\t\t\tif response.data.title?\n\t\t\t\t\t\trow.find('.woocommerce-PaymentMethod--method').html( response.data.title )\n\n\t\t\t\t\tif response.data.nonce?\n\t\t\t\t\t\t@ajax_nonce = response.data.nonce\n\n\t\t\t\t\t# change the \"Cancel\" button back to \"Edit\"\n\t\t\t\t\tbutton.siblings( '.cancel-edit' ).removeClass( 'cancel-edit' ).addClass( 'edit' ).text( @i18n.edit_button ).addClass( 'button' )\n\n\t\t\t\t\tthis.disable_editing_ui()\n\n\t\t\t\t.fail ( jqXHR, textStatus, error ) =>\n\n\t\t\t\t\tthis.display_error( row, error )\n\n\t\t\t\t.always =>\n\n\t\t\t\t\tthis.unblock_ui()\n\n\n\t\t# Cancels/stop editing a payment method.\n\t\t#\n\t\t# @since 5.1.0\n\t\t#\n\t\t# @param [Object] event jQuery event object\n\t\tcancel_edit: ( event ) =>\n\n\t\t\tevent.preventDefault()\n\n\t\t\tbutton = $( event.currentTarget )\n\t\t\trow    = button.parents( 'tr' )\n\n\t\t\t# check if the method belongs to this plugin\n\t\t\tif row.find( \"input[name=plugin-id][value=#{@slug}]\" ).length is 0\n\t\t\t\treturn\n\n\t\t\trow.find( 'div.view' ).show()\n\t\t\trow.find( 'div.edit' ).hide()\n\t\t\trow.removeClass( 'editing' )\n\n\t\t\t# change the \"Cancel\" button back to \"Edit\"\n\t\t\tbutton.removeClass( 'cancel-edit' ).addClass( 'edit' ).text( @i18n.edit_button ).addClass( 'button' )\n\n\t\t\tthis.disable_editing_ui()\n\n\n\t\t# Sets the page UI to the \"editing\" state.\n\t\t#\n\t\t# This brings proper focus to the method being edited and prevents\n\t\t# other available buttons/actions until the editing is finished or cancelled.\n\t\t#\n\t\t# @since 5.1.1\n\t\tenable_editing_ui: ->\n\n\t\t\t# set the methods table as 'editing'\n\t\t\t$( \".woocommerce-MyAccount-paymentMethods\" ).addClass( 'editing' )\n\n\t\t\t# disable the Add Payment Method button\n\t\t\t$( '.button[href*=\"add-payment-method\"]' ).addClass( 'disabled' )\n\n\n\t\t# Sets the page UI back to the default state.\n\t\t#\n\t\t# @since 5.1.1\n\t\tdisable_editing_ui: ->\n\n\t\t\t# removes the methods table's \"editing\" status\n\t\t\t$( \".woocommerce-MyAccount-paymentMethods\" ).removeClass( 'editing' )\n\n\t\t\t# re-enable the Add Payment Method button\n\t\t\t$( '.button[href*=\"add-payment-method\"]' ).removeClass( 'disabled' )\n\n\n\t\t# Blocks the payment methods table UI.\n\t\t#\n\t\t# @since 5.1.0\n\t\tblock_ui: -> $( \".woocommerce-MyAccount-paymentMethods\" ).parent( 'div' ).block( message: null, overlayCSS: background: '#fff', opacity: 0.6 )\n\n\n\t\t# Unblocks the payment methods table UI.\n\t\t#\n\t\t# @since 5.1.0\n\t\tunblock_ui: -> $( \".woocommerce-MyAccount-paymentMethods\" ).parent( 'div' ).unblock()\n\n\n\t\t# Displays an error message to the user.\n\t\t#\n\t\t# @since 5.1.0\n\t\t#\n\t\t# @param [Object] row payment method table row\n\t\t# @param [String] error raw error message\n\t\t# @param [String] message user error message\n\t\tdisplay_error: ( row, error, message = '' ) ->\n\n\t\t\tconsole.error( error )\n\n\t\t\tmessage = @i18n.save_error unless message\n\n\t\t\tcolumns = $( \".woocommerce-MyAccount-paymentMethods thead tr th\" ).size()\n\n\t\t\t$( '<tr class=\"error\"><td colspan=\"' + columns + '\">' + message + '</td></tr>' ).insertAfter( row ).find( 'td' ).delay( 8000 ).slideUp( 200 )\n\n\n\t# dispatch loaded event\n\t$( document.body ).trigger( 'sv_wc_payment_methods_handler_v5_10_0_loaded' )\n"]}