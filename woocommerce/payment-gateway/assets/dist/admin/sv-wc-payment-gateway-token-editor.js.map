{"mappings":"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","sources":["<anon>","woocommerce/payment-gateway/assets/js/admin/sv-wc-payment-gateway-token-editor.coffee"],"sourcesContent":["(function() {\n    /*\n   WooCommerce SkyVerge Payment Gateway Framework Token Editor CoffeeScript\n   Version 4.3.0-beta\n\n   Copyright (c) 2016, SkyVerge, Inc.\n   Licensed under the GNU General Public License v3.0\n   http://www.gnu.org/licenses/gpl-3.0.html\n  */ jQuery(function($) {\n        \"use strict\";\n        var handleError, ref, wc_payment_gateway_token_editor;\n        wc_payment_gateway_token_editor = (ref = window.wc_payment_gateway_token_editor) != null ? ref : {};\n        $(\".sv_wc_payment_gateway_token_editor\").each(function() {\n            var tokens;\n            tokens = $(this).find(\"tr.token\");\n            if (tokens.length === 0) return $(this).find(\"tr.no-tokens\").show();\n            else return $(this).find(\"tr.no-tokens\").hide();\n        });\n        // Remove a token\n        $(\".sv_wc_payment_gateway_token_editor\").on(\"click\", '.button[data-action=\"remove\"]', function(e) {\n            var data, editor, row;\n            e.preventDefault();\n            if (!confirm(wc_payment_gateway_token_editor.actions.remove_token.ays)) return;\n            editor = $(this).closest(\"table\");\n            editor.block({\n                message: null,\n                overlayCSS: {\n                    background: \"#fff\",\n                    opacity: 0.6\n                }\n            });\n            editor.find(\".error\").remove();\n            row = $(this).closest(\"tr\");\n            // if this is an unsaved token, just remove the row\n            if (row.hasClass(\"new-token\")) {\n                editor.unblock();\n                return row.remove();\n            }\n            data = {\n                action: \"wc_payment_gateway_\" + editor.data(\"gateway-id\") + \"_admin_remove_payment_token\",\n                user_id: $(this).data(\"user-id\"),\n                token_id: $(this).data(\"token-id\"),\n                security: wc_payment_gateway_token_editor.actions.remove_token.nonce\n            };\n            return $.post(wc_payment_gateway_token_editor.ajax_url, data).done(function(response) {\n                if (!response.success) return handleError(editor, response.data);\n                $(row).remove();\n                // no more tokens? Display a message\n                if (editor.find(\"tr.token\").length === 0) return editor.find(\"tr.no-tokens\").show();\n            }).fail(function(jqXHR, textStatus, error) {\n                return handleError(editor, textStatus + \": \" + error);\n            }).always(function() {\n                return editor.unblock();\n            });\n        });\n        // Add a new (blank) token\n        $(\"table.sv_wc_payment_gateway_token_editor\").on(\"click\", '.button[data-action=\"add-new\"]', function(e) {\n            var body, count, data, editor;\n            e.preventDefault();\n            editor = $(this).closest(\"table\");\n            editor.block({\n                message: null,\n                overlayCSS: {\n                    background: \"#fff\",\n                    opacity: 0.6\n                }\n            });\n            body = editor.find(\"tbody.tokens\");\n            count = body.find(\"tr.token\").length;\n            data = {\n                action: \"wc_payment_gateway_\" + editor.data(\"gateway-id\") + \"_admin_get_blank_payment_token\",\n                index: count + 1,\n                security: wc_payment_gateway_token_editor.actions.add_token.nonce\n            };\n            return $.post(wc_payment_gateway_token_editor.ajax_url, data, function(response) {\n                if (response.success === true) body.append(response.data);\n                editor.find(\"tr.no-tokens\").hide();\n                return editor.unblock();\n            });\n        });\n        // Refresh the tokens\n        $(\"table.sv_wc_payment_gateway_token_editor\").on(\"click\", '.button[data-action=\"refresh\"]', function(e) {\n            var body, count, data, editor;\n            e.preventDefault();\n            editor = $(this).closest(\"table\");\n            editor.block({\n                message: null,\n                overlayCSS: {\n                    background: \"#fff\",\n                    opacity: 0.6\n                }\n            });\n            editor.find(\".error\").remove();\n            body = editor.find(\"tbody.tokens\");\n            count = body.find(\"tr.token\").length;\n            data = {\n                action: \"wc_payment_gateway_\" + editor.data(\"gateway-id\") + \"_admin_refresh_payment_tokens\",\n                user_id: $(this).data(\"user-id\"),\n                security: wc_payment_gateway_token_editor.actions.refresh.nonce\n            };\n            return $.post(wc_payment_gateway_token_editor.ajax_url, data).done(function(response) {\n                if (!response.success) return handleError(editor, response.data);\n                if (response.data != null) {\n                    editor.find(\"tr.no-tokens\").hide();\n                    return body.html(response.data);\n                } else {\n                    body.empty();\n                    return editor.find(\"tr.no-tokens\").show();\n                }\n            }).fail(function(jqXHR, textStatus, error) {\n                return handleError(editor, textStatus + \": \" + error);\n            }).always(function() {\n                return editor.unblock();\n            });\n        });\n        // Save the tokens\n        $(\"table.sv_wc_payment_gateway_token_editor\").on(\"click\", '.sv-wc-payment-gateway-token-editor-action-button[data-action=\"save\"]', function(e) {\n            var actions_row, editor, focused, inputs;\n            editor = $(this).closest(\"table\");\n            actions_row = editor.find(\"tfoot th\");\n            editor.block({\n                message: null,\n                overlayCSS: {\n                    background: \"#fff\",\n                    opacity: 0.6\n                }\n            });\n            actions_row.find(\".error, .success\").remove();\n            inputs = editor.find('tbody.tokens tr.token input[type=\"text\"]');\n            focused = false;\n            return inputs.each(function(index) {\n                var pattern, required, value;\n                $(this).removeClass(\"error\");\n                value = $(this).val();\n                required = $(this).prop(\"required\");\n                pattern = $(this).attr(\"pattern\");\n                if (!(required || value)) return;\n                if (!value.match(pattern) || required && !value) {\n                    e.preventDefault();\n                    $(this).addClass(\"error\");\n                    if (!focused) {\n                        actions_row.prepend('<span class=\"error\">' + wc_payment_gateway_token_editor.actions.save.error + \"</span>\");\n                        $(this).focus();\n                        focused = true;\n                    }\n                    return editor.unblock();\n                }\n            });\n        });\n        // Handles any AJAX errors.\n        // @since 5.1.0\n        return handleError = function handleError(editor, error) {\n            var message = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : \"\";\n            console.error(error);\n            if (!message) message = wc_payment_gateway_token_editor.i18n.general_error;\n            return editor.find(\"th.actions\").prepend('<span class=\"error\">' + message + \"</span>\");\n        };\n    });\n}).call(module.exports);\n\n\n//# sourceMappingURL=sv-wc-payment-gateway-token-editor.js.map\n","###\n WooCommerce SkyVerge Payment Gateway Framework Token Editor CoffeeScript\n Version 4.3.0-beta\n\n Copyright (c) 2016, SkyVerge, Inc.\n Licensed under the GNU General Public License v3.0\n http://www.gnu.org/licenses/gpl-3.0.html\n###\njQuery ( $ ) ->\n\t\"use strict\"\n\n\twc_payment_gateway_token_editor = window.wc_payment_gateway_token_editor ? {}\n\n\n\t$( '.sv_wc_payment_gateway_token_editor' ).each () ->\n\n\t\ttokens = $( this ).find( 'tr.token' )\n\n\t\tif ( tokens.length is 0 )\n\t\t\t$( this ).find( 'tr.no-tokens' ).show()\n\t\telse\n\t\t\t$( this ).find( 'tr.no-tokens' ).hide()\n\n\n\t# Remove a token\n\t$( '.sv_wc_payment_gateway_token_editor' ).on 'click', '.button[data-action=\"remove\"]', ( e ) ->\n\n\t\te.preventDefault()\n\n\t\treturn unless confirm( wc_payment_gateway_token_editor.actions.remove_token.ays )\n\n\t\teditor = $( this ).closest( 'table' )\n\n\t\teditor.block( message: null, overlayCSS: background: '#fff',opacity: 0.6 )\n\n\t\teditor.find( '.error' ).remove()\n\n\t\trow = $( this ).closest( 'tr' )\n\n\t\t# if this is an unsaved token, just remove the row\n\t\tif row.hasClass( 'new-token' )\n\t\t\teditor.unblock()\n\t\t\treturn row.remove()\n\n\t\tdata =\n\t\t\taction:   'wc_payment_gateway_' + editor.data( 'gateway-id' ) + '_admin_remove_payment_token'\n\t\t\tuser_id:  $( this ).data( 'user-id' )\n\t\t\ttoken_id: $( this ).data( 'token-id' )\n\t\t\tsecurity: wc_payment_gateway_token_editor.actions.remove_token.nonce\n\n\t\t$.post wc_payment_gateway_token_editor.ajax_url, data\n\n\t\t\t.done ( response ) =>\n\n\t\t\t\treturn handleError( editor, response.data ) unless response.success\n\n\t\t\t\t$( row ).remove()\n\n\t\t\t\t# no more tokens? Display a message\n\t\t\t\tif ( editor.find( 'tr.token' ).length is 0 )\n\t\t\t\t\teditor.find( 'tr.no-tokens' ).show()\n\n\t\t\t.fail ( jqXHR, textStatus, error ) =>\n\n\t\t\t\thandleError( editor, textStatus + ': ' + error )\n\n\t\t\t.always =>\n\n\t\t\t\teditor.unblock()\n\n\n\n\n\t# Add a new (blank) token\n\t$( 'table.sv_wc_payment_gateway_token_editor' ).on 'click', '.button[data-action=\"add-new\"]', ( e ) ->\n\n\t\te.preventDefault()\n\n\t\teditor = $( this ).closest( 'table' )\n\n\t\teditor.block( message: null, overlayCSS: background: '#fff',opacity: 0.6 )\n\n\t\tbody  = editor.find( 'tbody.tokens' )\n\t\tcount = body.find( 'tr.token' ).length\n\n\t\tdata =\n\t\t\taction:   'wc_payment_gateway_' + editor.data( 'gateway-id' ) + '_admin_get_blank_payment_token'\n\t\t\tindex:    count + 1\n\t\t\tsecurity: wc_payment_gateway_token_editor.actions.add_token.nonce\n\n\t\t$.post wc_payment_gateway_token_editor.ajax_url, data, ( response ) ->\n\n\t\t\tif response.success is true then body.append( response.data )\n\n\t\t\teditor.find( 'tr.no-tokens' ).hide()\n\n\t\t\teditor.unblock()\n\n\n\t# Refresh the tokens\n\t$( 'table.sv_wc_payment_gateway_token_editor' ).on 'click', '.button[data-action=\"refresh\"]', ( e ) ->\n\n\t\te.preventDefault()\n\n\t\teditor = $( this ).closest( 'table' )\n\n\t\teditor.block( message: null, overlayCSS: background: '#fff',opacity: 0.6 )\n\n\t\teditor.find( '.error' ).remove()\n\n\t\tbody  = editor.find( 'tbody.tokens' )\n\t\tcount = body.find( 'tr.token' ).length\n\n\t\tdata =\n\t\t\taction:   'wc_payment_gateway_' + editor.data( 'gateway-id' ) + '_admin_refresh_payment_tokens'\n\t\t\tuser_id:  $( this ).data( 'user-id' )\n\t\t\tsecurity: wc_payment_gateway_token_editor.actions.refresh.nonce\n\n\t\t$.post wc_payment_gateway_token_editor.ajax_url, data\n\n\t\t\t.done ( response ) =>\n\n\t\t\t\treturn handleError( editor, response.data ) unless response.success\n\n\t\t\t\tif response.data?\n\t\t\t\t\teditor.find( 'tr.no-tokens' ).hide()\n\t\t\t\t\tbody.html( response.data )\n\t\t\t\telse\n\t\t\t\t\tbody.empty()\n\t\t\t\t\teditor.find( 'tr.no-tokens' ).show()\n\n\t\t\t.fail ( jqXHR, textStatus, error ) =>\n\n\t\t\t\thandleError( editor, textStatus + ': ' + error )\n\n\t\t\t.always =>\n\n\t\t\t\teditor.unblock()\n\n\t# Save the tokens\n\t$( 'table.sv_wc_payment_gateway_token_editor' ).on 'click', '.sv-wc-payment-gateway-token-editor-action-button[data-action=\"save\"]', ( e ) ->\n\n\t\teditor      = $( this ).closest( 'table' )\n\t\tactions_row = editor.find( 'tfoot th' )\n\n\t\teditor.block( message: null, overlayCSS: background: '#fff',opacity: 0.6 )\n\n\t\tactions_row.find( '.error, .success' ).remove();\n\n\t\t# Validate the input data\n\n\t\tinputs  = editor.find( 'tbody.tokens tr.token input[type=\"text\"]' )\n\t\tfocused = false\n\n\t\tinputs.each ( index ) ->\n\n\t\t\t$( this ).removeClass( 'error' )\n\n\t\t\tvalue    = $( this ).val()\n\t\t\trequired = $( this ).prop( 'required' )\n\t\t\tpattern  = $( this ).attr( 'pattern' )\n\n\t\t\treturn unless required or value\n\n\t\t\tif ( ! value.match( pattern ) or ( required and ! value ) )\n\n\t\t\t\te.preventDefault()\n\n\t\t\t\t$( this ).addClass( 'error' )\n\n\t\t\t\tif ( ! focused )\n\t\t\t\t\tactions_row.prepend( '<span class=\"error\">' + wc_payment_gateway_token_editor.actions.save.error + '</span>' )\n\t\t\t\t\t$( this ).focus()\n\t\t\t\t\tfocused = true\n\n\t\t\t\teditor.unblock()\n\n\n\t# Handles any AJAX errors.\n\t#\n\t# @since 5.1.0\n\thandleError = ( editor, error, message = '' ) ->\n\n\t\tconsole.error error\n\n\t\tmessage = wc_payment_gateway_token_editor.i18n.general_error unless message\n\n\t\teditor.find( 'th.actions' ).prepend( '<span class=\"error\">' + message + '</span>' )\n"],"names":["jQuery","$","handleError","ref","wc_payment_gateway_token_editor","window","each","tokens","find","length","show","hide","on","e","data","editor","row","preventDefault","confirm","actions","remove_token","ays","closest","block","message","overlayCSS","background","opacity","remove","hasClass","unblock","action","user_id","token_id","security","nonce","post","ajax_url","done","response","success","fail","jqXHR","textStatus","error","always","body","count","index","add_token","append","refresh","html","empty","actions_row","focused","inputs","pattern","required","value","removeClass","val","prop","attr","match","addClass","prepend","save","focus","arguments","console","i18n","general_error","call","module","exports"],"version":3,"file":"sv-wc-payment-gateway-token-editor.js.map","sourceRoot":"../../../../../"}