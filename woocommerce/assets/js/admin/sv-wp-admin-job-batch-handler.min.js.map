{
  "version": 3,
  "file": "sv-wp-admin-job-batch-handler.min.js",
  "sourceRoot": "",
  "sources": [
    "sv-wp-admin-job-batch-handler.coffee"
  ],
  "names": [],
  "mappings": "AAIG;EAAA;;;;;EAEH,MAAA,CAAO,QAAA,CAAE,CAAF,CAAA;IACN,aAAD;;;;WAMO,MAAM,CAAC,0BAAb,MAAA,wBAAA,CAAA;;;;;;;;MAUC,WAAa,CAAE,IAAF,CAAA,EAAA;;;;;;;YAcb,CAAA,kBAAA,CAAA;QAZC,IAAC,CAAA,EAAD,GAAiB,IAAI,CAAC;QACtB,IAAC,CAAA,aAAD,GAAiB,IAAI,CAAC;QACtB,IAAC,CAAA,YAAD,GAAiB,IAAI,CAAC;QACtB,IAAC,CAAA,SAAD,GAAiB;MALL;;MAcb,WAAa,CAAE,MAAF,CAAA;eAAc,IAAI,OAAJ,CAAY,CAAE,OAAF,EAAW,MAAX,CAAA,GAAA;AAEzC,cAAA;UACG,IAAoC,IAAC,CAAA,SAAD,KAAc,MAAlD;;AAAA,mBAAO,IAAI,CAAC,UAAL,CAAiB,MAAjB,EAAP;;UAEA,IAAA,GACC;YAAA,MAAA,EAAU,CAAA,CAAA,CAAG,IAAC,CAAA,EAAJ,CAAA,cAAA,CAAV;YACA,QAAA,EAAU,IAAC,CAAA,aADX;YAEA,MAAA,EAAU;UAFV;iBAID,CAAC,CAAC,IAAF,CAAQ,OAAR,EAAiB,IAAjB,CAEC,CAAC,IAFF,CAEO,CAAE,QAAF,CAAA,GAAA;YAGL,MAA8B,QAAQ,CAAC,OAAT,IAAqB,wBAAnD;;AAAA,qBAAO,MAAA,CAAO,QAAP,EAAP;;YAGA,IAA+B,QAAQ,CAAC,IAAI,CAAC,MAAd,KAAwB,YAAvD;;AAAA,qBAAO,OAAA,CAAQ,QAAR,EAAP;aAJL;;YAOK,CAAA,CAAG,QAAH,CAAa,CAAC,OAAd,CAAsB,CAAA,CAAA,CAAG,IAAC,CAAA,EAAJ,CAAA,gBAAA,CAAA,CAAyB,QAAQ,CAAC,IAAI,CAAC,EAAvC,CAAA,CAAtB,EACC;cAAA,UAAA,EAAY,QAAQ,CAAC,IAAI,CAAC,UAA1B;cACA,QAAA,EAAY,QAAQ,CAAC,IAAI,CAAC,QAD1B;cAEA,KAAA,EAAY,QAAQ,CAAC,IAAI,CAAC;YAF1B,CADD,EAPL;;AAaK,mBAAO,OAAA,CAAQ,IAAI,CAAC,WAAL,CAAkB,QAAQ,CAAC,IAAI,CAAC,EAAhC,CAAR;UAfF,CAFP,CAmBC,CAAC,IAnBF,CAmBO,QAAA,CAAE,KAAF,EAAS,UAAT,EAAqB,KAArB,CAAA;mBAEL,MAAA,CAAO,KAAP,EAFK;UAAA,CAnBP;QAVsC,CAAZ;MAAd,CArBf;;;;;;;;;MA6DE,UAAY,CAAE,MAAF,CAAA;eAAc,IAAI,OAAJ,CAAY,CAAE,OAAF,EAAW,MAAX,CAAA,GAAA;AAExC,cAAA;UAAG,IAAC,CAAA,SAAD,GAAa;UAEb,IAAA,GACC;YAAA,MAAA,EAAU,CAAA,CAAA,CAAG,IAAC,CAAA,EAAJ,CAAA,WAAA,CAAV;YACA,QAAA,EAAU,IAAC,CAAA,YADX;YAEA,MAAA,EAAU;UAFV;iBAID,CAAC,CAAC,IAAF,CAAQ,OAAR,EAAiB,IAAjB,CAEC,CAAC,IAFF,CAEO,QAAA,CAAE,QAAF,CAAA;YAEL,KAA8B,QAAQ,CAAC,OAAvC;AAAA,qBAAO,MAAA,CAAO,QAAP,EAAP;;AAEA,mBAAO,OAAA,CAAQ,QAAR;UAJF,CAFP,CAQC,CAAC,IARF,CAQO,QAAA,CAAE,KAAF,EAAS,UAAT,EAAqB,KAArB,CAAA;mBAEL,MAAA,CAAO,KAAP;UAFK,CARP;QATqC,CAAZ;MAAd;;IAhEb;EAPM,CAAP;AAFG",
  "sourcesContent": [
    "###*\n# WordPress Batch Job Handler\n#\n# @since 4.8.0\n###\n\njQuery ( $ ) ->\n\t'use strict'\n\n\n\t# Handles batch processing job items.\n\t#\n\t# @since 4.8.0\n\tclass window.SV_WP_Job_Batch_Handler\n\n\n\t\t# Constructs the class.\n\t\t#\n\t\t# @since 4.8.0\n\t\t#\n\t\t# @params [Object] args with properties:\n\t\t#     id:    job handler ID, used for naming actions and events\n\t\t#     nonce: nonce for AJAX requests\n\t\tconstructor: ( args ) ->\n\n\t\t\t@id            = args.id\n\t\t\t@process_nonce = args.process_nonce\n\t\t\t@cancel_nonce  = args.cancel_nonce\n\t\t\t@cancelled     = false\n\n\n\t\t# Processes a given job ID in batches.\n\t\t#\n\t\t# @since 4.8.0\n\t\t#\n\t\t# @param [String] an existing job ID\n\t\t# @returns [Promise]\n\t\tprocess_job: ( job_id ) => new Promise ( resolve, reject ) =>\n\n\t\t\t# halt batch processing if a job is cancelled by user action\n\t\t\treturn this.cancel_job( job_id ) if @cancelled is job_id\n\n\t\t\tdata =\n\t\t\t\taction:   \"#{@id}_process_batch\"\n\t\t\t\tsecurity: @process_nonce\n\t\t\t\tjob_id:   job_id\n\n\t\t\t$.post( ajaxurl, data )\n\n\t\t\t\t.done ( response ) =>\n\n\t\t\t\t\t# trigger an error if an error is returned or the job data is missing\n\t\t\t\t\treturn reject response unless response.success and response.data?\n\n\t\t\t\t\t# we're done if the job is anything but still processing\n\t\t\t\t\treturn resolve response unless response.data.status is 'processing'\n\n\t\t\t\t\t# broadcast the job progress\n\t\t\t\t\t$( document ).trigger \"#{@id}_batch_progress_#{response.data.id}\",\n\t\t\t\t\t\tpercentage: response.data.percentage\n\t\t\t\t\t\tprogress:   response.data.progress\n\t\t\t\t\t\ttotal:      response.data.total\n\n\t\t\t\t\t# continue processing until finished\n\t\t\t\t\treturn resolve this.process_job( response.data.id )\n\n\t\t\t\t.fail ( jqXHR, textStatus, error ) ->\n\n\t\t\t\t\treject error # TODO: anything more we can do here?\n\n\n\t\t# Cancels a given job.\n\t\t#\n\t\t# @since 4.8.0\n\t\t#\n\t\t# @param [String] an existing job ID\n\t\t# @returns [Promise]\n\t\tcancel_job: ( job_id ) -> new Promise ( resolve, reject ) =>\n\n\t\t\t@cancelled = false\n\n\t\t\tdata =\n\t\t\t\taction:   \"#{@id}_cancel_job\"\n\t\t\t\tsecurity: @cancel_nonce\n\t\t\t\tjob_id:   job_id\n\n\t\t\t$.post( ajaxurl, data )\n\n\t\t\t\t.done ( response ) ->\n\n\t\t\t\t\treturn reject response unless response.success\n\n\t\t\t\t\treturn resolve response\n\n\t\t\t\t.fail ( jqXHR, textStatus, error ) ->\n\n\t\t\t\t\treject error\n"
  ]
}